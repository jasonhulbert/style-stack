@import '../../core/query.core';
@import '../../core/selector.core';
@import '../base/font.lib';
@import '../base/global.lib';
@import '../modifiers/box.lib';

$text-name: 'text' !default;
$text-scales: (
    'none': 1,
    'xs': 0.8,
    'sm': 0.9,
    'md': 1.25,
    'lg': 1.75,
    'xl': 2.25,
    'xxl': 3
) !default;
$text-margin: 0 0 box-value(4) !default;
$text-line-height: 1.3 !default;

@mixin text($scale-key: false, $weight: $font-text-weight-default) {
    @include text-weight($weight);
    margin: $text-margin;
    line-height: $text-line-height;

    @if ($scale-key) {
        @include text-scale($scale-key);
    }
}

@mixin text-weight($weight: $font-text-weight-default) {
    @include font-weight($font-text-family, $weight);
}

@mixin text-scale($scale-key) {
    $scale-value: 1;

    @if map-has-key($text-scales, $scale-key) {
        $scale-value: map-get($text-scales, $scale-key);
    } @else {
        @warn 'text scale "#{$scale-key}" does not exist in "$text-scales"';
    }

    font-size: $global-body-font-size * $scale-value;
}

@mixin text-no-margin() {
    margin-top: 0;
    margin-bottom: 0;
}

@mixin text-styles() {
    $name: selector-prefix($text-name);

    .#{$name} {
        @include text();
    }

    .#{$name}-upper {
        text-transform: uppercase;
    }

    .#{$name}-no-margin {
        @include text-no-margin();
    }

    @each $scale-key in map-keys($text-scales) {
        .#{$name}-scale-#{$scale-key} {
            @include text-scale($scale-key);
        }
    }

    @each $weight in map-get($font-weights, $font-text-family) {
        .#{$name}-weight-#{$weight} {
            font-weight: $weight;
        }
    }

    @each $query-key in map-keys($query-map) {
        @include query($query-key) {
            .#{$name}-no-margin\@#{$query-key} {
                @include text-no-margin();
            }

            @each $scale-key in map-keys($text-scales) {
                .#{$name}-scale-#{$scale-key}\@#{$query-key} {
                    @include text-scale($scale-key);
                }
            }
        }
    }

    @if mixin-exists('text-hook') {
        @include text-hook($name);
    }
}
