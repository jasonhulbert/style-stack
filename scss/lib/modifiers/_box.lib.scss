@import '../../core/query.core';
@import '../../core/selector.core';

$box-name: 'box' !default;
$box-base-value: 0.3rem !default;
$box-multiplier-max: 10 !default;
$box-multiplier-default: 4 !default;
$box-sides-map: (
    't': top,
    'r': right,
    'b': bottom,
    'l': left,
    'tb': (top bottom),
    'rl': (left right),
    'trbl': (top right bottom left)
) !default;
$box-sides-default: 'rl' !default;

@function box-value($multiplier) {
    @return $multiplier * $box-base-value;
}

@mixin box-property($property, $multiplier: $box-multiplier-default, $sides: $box-sides-default) {
    $sides-list: ();

    @if map-has-key($box-sides-map, $sides) {
        $sides-list: map-get($box-sides-map, $sides);
    } @else if type-of($sides) == string {
        $sides-list: $sides;
    }

    @if length($sides-list) == 4 {
        #{$property}: box-value($multiplier);
    } @else {
        @each $side in $sides-list {
            #{$property}-#{$side}: box-value($multiplier);
        }
    }
}

@mixin box-padding($multiplier: $box-multiplier-default, $sides: $box-sides-default) {
    @include box-property('padding', $multiplier, $sides);
}

@mixin box-margin($multiplier: $box-multiplier-default, $sides: $box-sides-default) {
    @include box-property('margin', $multiplier, $sides);
}

@mixin box-styles() {
    $name: selector-prefix($box-name);

    .#{$name}-margin {
        @include box-margin();
    }

    .#{$name}-padding {
        @include box-padding();
    }

    .#{$name}-margin-auto {
        margin: 0 auto;
    }

    @each $sides-key, $sides-list in $box-sides-map {
        .#{$name}-margin-#{$sides-key} {
            @include box-margin($sides: $sides-key);
        }

        .#{$name}-padding-#{$sides-key} {
            @include box-padding($sides: $sides-key);
        }

        @for $i from 1 through $box-multiplier-max {
            .#{$name}-margin-#{$i}-#{$sides-key} {
                @include box-margin($i, $sides-key);
            }

            .#{$name}-padding-#{$i}-#{$sides-key} {
                @include box-padding($i, $sides-key);
            }
        }
    }

    @each $query-key in map-keys($query-map) {
        @include query($query-key) {
            .#{$name}-margin\@#{$query-key} {
                @include box-margin();
            }

            .#{$name}-padding\@#{$query-key} {
                @include box-padding();
            }

            .#{$name}-margin-auto\@#{$query-key} {
                margin: 0 auto;
            }

            @each $sides-key, $sides-list in $box-sides-map {
                .#{$name}-margin-#{$sides-key}\@#{$query-key} {
                    @include box-margin($sides: $sides-key);
                }

                .#{$name}-padding-#{$sides-key}\@#{$query-key} {
                    @include box-padding($sides: $sides-key);
                }

                @for $i from 1 through $box-multiplier-max {
                    .#{$name}-margin-#{$i}-#{$sides-key}\@#{$query-key} {
                        @include box-margin($i, $sides-key);
                    }

                    .#{$name}-padding-#{$i}-#{$sides-key}\@#{$query-key} {
                        @include box-padding($i, $sides-key);
                    }
                }
            }
        }
    }

    @if mixin-exists('box-hook') {
        @include box-hook($name);
    }
}
